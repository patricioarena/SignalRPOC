{"ast":null,"code":"import { isDevMode } from '@angular/core';\nimport * as signalR from '@aspnet/signalr';\nimport { ExpectedMessage } from './expected.messages';\nimport * as i0 from \"@angular/core\";\nexport class SignalRService {\n  constructor() {\n    this.userId = 12345;\n    this.username = \"alice\";\n    this.picture = \"https://i.pinimg.com/originals/35/0e/dd/350edd537688ad50ea3c5615e02ba84e.jpg\";\n    this.actualUrl = \"http://localhost:4200/\";\n    this.startConnection = () => {\n      this.hubConnection = new signalR.HubConnectionBuilder().withUrl(`https://localhost:44385/SignalHub?userId=${this.userId}`).build();\n      this.hubConnection.start().then(() => console.log(\"Connection started\")).catch(err => console.error(\"Error while starting connection: \" + err));\n      this.hubConnection.on(ExpectedMessage.welcome, data => {\n        console.log(`Welcome: ${JSON.stringify(data)}`);\n        const payload = {\n          userId: this.userId,\n          username: this.username,\n          connectionId: data.connectionId,\n          url: this.actualUrl,\n          picture: this.picture\n        };\n        this.sendPayload(payload);\n      });\n      this.hubConnection.on('ReceivePayloadResponse', data => {\n        isDevMode() && console.log({\n          data: JSON.stringify(data)\n        });\n      });\n      this.hubConnection.on(ExpectedMessage.show_notification, () => {\n        this.showNotification();\n      });\n    };\n  }\n  sendPayload(payload) {\n    this.hubConnection.invoke('ReceivePayload', payload).catch(err => console.error(err));\n  }\n  showNotification() {\n    var notification = new Notification(this.username, {\n      body: 'You clicked on the button!',\n      icon: 'https://i.pinimg.com/originals/35/0e/dd/350edd537688ad50ea3c5615e02ba84e.jpg'\n    });\n    setTimeout(function () {\n      notification.close();\n    }, 5000);\n  }\n  static #_ = this.ɵfac = function SignalRService_Factory(t) {\n    return new (t || SignalRService)();\n  };\n  static #_2 = this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: SignalRService,\n    factory: SignalRService.ɵfac,\n    providedIn: 'root'\n  });\n}","map":{"version":3,"names":["isDevMode","signalR","ExpectedMessage","SignalRService","constructor","userId","username","picture","actualUrl","startConnection","hubConnection","HubConnectionBuilder","withUrl","build","start","then","console","log","catch","err","error","on","welcome","data","JSON","stringify","payload","connectionId","url","sendPayload","show_notification","showNotification","invoke","notification","Notification","body","icon","setTimeout","close","_","_2","factory","ɵfac","providedIn"],"sources":["C:\\Users\\patri\\source\\repos\\SignalRPOC\\MockFrontend-1\\src\\app\\signal-r.service.ts"],"sourcesContent":["import { Injectable, isDevMode } from '@angular/core';\r\nimport * as signalR from '@aspnet/signalr';\r\nimport { ExpectedMessage } from './expected.messages';\r\n\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class SignalRService {\r\n  private userId: number = 12345;\r\n  private username: string = \"alice\";\r\n  private picture: string = \"https://i.pinimg.com/originals/35/0e/dd/350edd537688ad50ea3c5615e02ba84e.jpg\"\r\n  private actualUrl: string = \"http://localhost:4200/\"\r\n\r\n  private hubConnection: signalR.HubConnection;\r\n\r\n  public startConnection = () => {\r\n    this.hubConnection = new signalR.HubConnectionBuilder()\r\n      .withUrl(`https://localhost:44385/SignalHub?userId=${this.userId}`)\r\n      .build();\r\n\r\n    this.hubConnection.start()\r\n      .then(() => console.log(\"Connection started\"))\r\n      .catch(err => console.error(\"Error while starting connection: \" + err));\r\n\r\n\r\n\r\n    this.hubConnection.on(ExpectedMessage.welcome, (data) => {\r\n      console.log(`Welcome: ${JSON.stringify(data)}`);\r\n\r\n      const payload = {\r\n        userId: this.userId,\r\n        username: this.username,\r\n        connectionId: data.connectionId,\r\n        url: this.actualUrl,\r\n        picture: this.picture\r\n      }\r\n\r\n      this.sendPayload(payload);\r\n\r\n    });\r\n\r\n\r\n    this.hubConnection.on('ReceivePayloadResponse', (data) => {\r\n      isDevMode() && console.log({\r\n        data: JSON.stringify(data)\r\n      })\r\n    });\r\n\r\n    this.hubConnection.on(ExpectedMessage.show_notification, () => {\r\n      this.showNotification();\r\n    });\r\n  }\r\n\r\n  public sendPayload(payload: any) {\r\n    this.hubConnection.invoke('ReceivePayload', payload)\r\n      .catch(err => console.error(err));\r\n  }\r\n\r\n  private showNotification() {\r\n    var notification = new Notification(this.username, {\r\n      body: 'You clicked on the button!',\r\n      icon: 'https://i.pinimg.com/originals/35/0e/dd/350edd537688ad50ea3c5615e02ba84e.jpg'\r\n    });\r\n    setTimeout(function () { notification.close(); }, 5000);\r\n  }\r\n}\r\n"],"mappings":"AAAA,SAAqBA,SAAS,QAAQ,eAAe;AACrD,OAAO,KAAKC,OAAO,MAAM,iBAAiB;AAC1C,SAASC,eAAe,QAAQ,qBAAqB;;AAMrD,OAAM,MAAOC,cAAc;EAH3BC,YAAA;IAIU,KAAAC,MAAM,GAAW,KAAK;IACtB,KAAAC,QAAQ,GAAW,OAAO;IAC1B,KAAAC,OAAO,GAAW,8EAA8E;IAChG,KAAAC,SAAS,GAAW,wBAAwB;IAI7C,KAAAC,eAAe,GAAG,MAAK;MAC5B,IAAI,CAACC,aAAa,GAAG,IAAIT,OAAO,CAACU,oBAAoB,EAAE,CACpDC,OAAO,CAAC,4CAA4C,IAAI,CAACP,MAAM,EAAE,CAAC,CAClEQ,KAAK,EAAE;MAEV,IAAI,CAACH,aAAa,CAACI,KAAK,EAAE,CACvBC,IAAI,CAAC,MAAMC,OAAO,CAACC,GAAG,CAAC,oBAAoB,CAAC,CAAC,CAC7CC,KAAK,CAACC,GAAG,IAAIH,OAAO,CAACI,KAAK,CAAC,mCAAmC,GAAGD,GAAG,CAAC,CAAC;MAIzE,IAAI,CAACT,aAAa,CAACW,EAAE,CAACnB,eAAe,CAACoB,OAAO,EAAGC,IAAI,IAAI;QACtDP,OAAO,CAACC,GAAG,CAAC,YAAYO,IAAI,CAACC,SAAS,CAACF,IAAI,CAAC,EAAE,CAAC;QAE/C,MAAMG,OAAO,GAAG;UACdrB,MAAM,EAAE,IAAI,CAACA,MAAM;UACnBC,QAAQ,EAAE,IAAI,CAACA,QAAQ;UACvBqB,YAAY,EAAEJ,IAAI,CAACI,YAAY;UAC/BC,GAAG,EAAE,IAAI,CAACpB,SAAS;UACnBD,OAAO,EAAE,IAAI,CAACA;SACf;QAED,IAAI,CAACsB,WAAW,CAACH,OAAO,CAAC;MAE3B,CAAC,CAAC;MAGF,IAAI,CAAChB,aAAa,CAACW,EAAE,CAAC,wBAAwB,EAAGE,IAAI,IAAI;QACvDvB,SAAS,EAAE,IAAIgB,OAAO,CAACC,GAAG,CAAC;UACzBM,IAAI,EAAEC,IAAI,CAACC,SAAS,CAACF,IAAI;SAC1B,CAAC;MACJ,CAAC,CAAC;MAEF,IAAI,CAACb,aAAa,CAACW,EAAE,CAACnB,eAAe,CAAC4B,iBAAiB,EAAE,MAAK;QAC5D,IAAI,CAACC,gBAAgB,EAAE;MACzB,CAAC,CAAC;IACJ,CAAC;;EAEMF,WAAWA,CAACH,OAAY;IAC7B,IAAI,CAAChB,aAAa,CAACsB,MAAM,CAAC,gBAAgB,EAAEN,OAAO,CAAC,CACjDR,KAAK,CAACC,GAAG,IAAIH,OAAO,CAACI,KAAK,CAACD,GAAG,CAAC,CAAC;EACrC;EAEQY,gBAAgBA,CAAA;IACtB,IAAIE,YAAY,GAAG,IAAIC,YAAY,CAAC,IAAI,CAAC5B,QAAQ,EAAE;MACjD6B,IAAI,EAAE,4BAA4B;MAClCC,IAAI,EAAE;KACP,CAAC;IACFC,UAAU,CAAC;MAAcJ,YAAY,CAACK,KAAK,EAAE;IAAE,CAAC,EAAE,IAAI,CAAC;EACzD;EAAC,QAAAC,CAAA,G;qBAzDUpC,cAAc;EAAA;EAAA,QAAAqC,EAAA,G;WAAdrC,cAAc;IAAAsC,OAAA,EAAdtC,cAAc,CAAAuC,IAAA;IAAAC,UAAA,EAFb;EAAM","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}