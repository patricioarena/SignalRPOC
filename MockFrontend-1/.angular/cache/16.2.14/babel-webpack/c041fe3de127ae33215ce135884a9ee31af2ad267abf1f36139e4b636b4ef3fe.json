{"ast":null,"code":"import * as signalR from '@aspnet/signalr';\nimport { ExpectedMessage } from './expected.messages';\nimport * as i0 from \"@angular/core\";\nexport class SignalRService {\n  constructor() {\n    this.connectionName = \"alice\"; // Puedes cambiar esto o hacerlo configurable\n    this.connectionId = \"\";\n    this.startConnection = () => {\n      this.hubConnection = new signalR.HubConnectionBuilder().withUrl(`https://localhost:44385/SignalHub?connectionName=${this.connectionName}`).build();\n      this.hubConnection.start().then(() => console.log(\"Connection started\")).catch(err => console.error(\"Error while starting connection: \" + err));\n      this.hubConnection.on(ExpectedMessage.welcome, connectionId => {\n        console.log(`Welcome: ${connectionId}`);\n        this.connectionId = connectionId;\n        // this.hubConnection.invoke(\"GetData\", \"user id\", connectionId)\n        //   .catch(err => console.error(err));\n      });\n\n      this.hubConnection.on('ReceivePayloa', () => {\n        this.showNotification();\n      });\n      this.hubConnection.on(ExpectedMessage.show_notification, () => {\n        this.showNotification();\n      });\n    };\n  }\n  sendPayload(payload) {\n    this.hubConnection.invoke('ReceivePayload', this.connectionId, payload).catch(err => console.error(err));\n  }\n  showNotification() {\n    var notification = new Notification(this.connectionName, {\n      body: 'You clicked on the button!',\n      icon: 'https://i.pinimg.com/originals/35/0e/dd/350edd537688ad50ea3c5615e02ba84e.jpg'\n    });\n    setTimeout(function () {\n      notification.close();\n    }, 5000);\n  }\n  static #_ = this.ɵfac = function SignalRService_Factory(t) {\n    return new (t || SignalRService)();\n  };\n  static #_2 = this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: SignalRService,\n    factory: SignalRService.ɵfac,\n    providedIn: 'root'\n  });\n}","map":{"version":3,"names":["signalR","ExpectedMessage","SignalRService","constructor","connectionName","connectionId","startConnection","hubConnection","HubConnectionBuilder","withUrl","build","start","then","console","log","catch","err","error","on","welcome","showNotification","show_notification","sendPayload","payload","invoke","notification","Notification","body","icon","setTimeout","close","_","_2","factory","ɵfac","providedIn"],"sources":["C:\\Users\\patri\\source\\repos\\SignalRPOC\\MockFrontend-1\\src\\app\\signal-r.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\r\nimport * as signalR from '@aspnet/signalr';\r\nimport { ExpectedMessage } from './expected.messages';\r\n\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class SignalRService {\r\n  private hubConnection: signalR.HubConnection;\r\n  private connectionName: string = \"alice\"; // Puedes cambiar esto o hacerlo configurable\r\n  private connectionId: string = \"\";\r\n\r\n  public startConnection = () => {\r\n    this.hubConnection = new signalR.HubConnectionBuilder()\r\n      .withUrl(`https://localhost:44385/SignalHub?connectionName=${this.connectionName}`)\r\n      .build();\r\n\r\n    this.hubConnection.start()\r\n      .then(() => console.log(\"Connection started\"))\r\n      .catch(err => console.error(\"Error while starting connection: \" + err));\r\n\r\n\r\n\r\n    this.hubConnection.on(ExpectedMessage.welcome, (connectionId) => {\r\n      console.log(`Welcome: ${connectionId}`);\r\n      this.connectionId = connectionId;\r\n\r\n      // this.hubConnection.invoke(\"GetData\", \"user id\", connectionId)\r\n      //   .catch(err => console.error(err));\r\n\r\n\r\n    });\r\n\r\n\r\n    this.hubConnection.on('ReceivePayloa', () => {\r\n      this.showNotification();\r\n    });\r\n\r\n    this.hubConnection.on(ExpectedMessage.show_notification, () => {\r\n      this.showNotification();\r\n    });\r\n  }\r\n\r\n  public sendPayload(payload: any) {\r\n    this.hubConnection.invoke('ReceivePayload', this.connectionId, payload)\r\n      .catch(err => console.error(err));\r\n  }\r\n\r\n  private showNotification() {\r\n    var notification = new Notification(this.connectionName, {\r\n      body: 'You clicked on the button!',\r\n      icon: 'https://i.pinimg.com/originals/35/0e/dd/350edd537688ad50ea3c5615e02ba84e.jpg'\r\n    });\r\n    setTimeout(function () { notification.close(); }, 5000);\r\n  }\r\n}\r\n"],"mappings":"AACA,OAAO,KAAKA,OAAO,MAAM,iBAAiB;AAC1C,SAASC,eAAe,QAAQ,qBAAqB;;AAMrD,OAAM,MAAOC,cAAc;EAH3BC,YAAA;IAKU,KAAAC,cAAc,GAAW,OAAO,CAAC,CAAC;IAClC,KAAAC,YAAY,GAAW,EAAE;IAE1B,KAAAC,eAAe,GAAG,MAAK;MAC5B,IAAI,CAACC,aAAa,GAAG,IAAIP,OAAO,CAACQ,oBAAoB,EAAE,CACpDC,OAAO,CAAC,oDAAoD,IAAI,CAACL,cAAc,EAAE,CAAC,CAClFM,KAAK,EAAE;MAEV,IAAI,CAACH,aAAa,CAACI,KAAK,EAAE,CACvBC,IAAI,CAAC,MAAMC,OAAO,CAACC,GAAG,CAAC,oBAAoB,CAAC,CAAC,CAC7CC,KAAK,CAACC,GAAG,IAAIH,OAAO,CAACI,KAAK,CAAC,mCAAmC,GAAGD,GAAG,CAAC,CAAC;MAIzE,IAAI,CAACT,aAAa,CAACW,EAAE,CAACjB,eAAe,CAACkB,OAAO,EAAGd,YAAY,IAAI;QAC9DQ,OAAO,CAACC,GAAG,CAAC,YAAYT,YAAY,EAAE,CAAC;QACvC,IAAI,CAACA,YAAY,GAAGA,YAAY;QAEhC;QACA;MAGF,CAAC,CAAC;;MAGF,IAAI,CAACE,aAAa,CAACW,EAAE,CAAC,eAAe,EAAE,MAAK;QAC1C,IAAI,CAACE,gBAAgB,EAAE;MACzB,CAAC,CAAC;MAEF,IAAI,CAACb,aAAa,CAACW,EAAE,CAACjB,eAAe,CAACoB,iBAAiB,EAAE,MAAK;QAC5D,IAAI,CAACD,gBAAgB,EAAE;MACzB,CAAC,CAAC;IACJ,CAAC;;EAEME,WAAWA,CAACC,OAAY;IAC7B,IAAI,CAAChB,aAAa,CAACiB,MAAM,CAAC,gBAAgB,EAAE,IAAI,CAACnB,YAAY,EAAEkB,OAAO,CAAC,CACpER,KAAK,CAACC,GAAG,IAAIH,OAAO,CAACI,KAAK,CAACD,GAAG,CAAC,CAAC;EACrC;EAEQI,gBAAgBA,CAAA;IACtB,IAAIK,YAAY,GAAG,IAAIC,YAAY,CAAC,IAAI,CAACtB,cAAc,EAAE;MACvDuB,IAAI,EAAE,4BAA4B;MAClCC,IAAI,EAAE;KACP,CAAC;IACFC,UAAU,CAAC;MAAcJ,YAAY,CAACK,KAAK,EAAE;IAAE,CAAC,EAAE,IAAI,CAAC;EACzD;EAAC,QAAAC,CAAA,G;qBA/CU7B,cAAc;EAAA;EAAA,QAAA8B,EAAA,G;WAAd9B,cAAc;IAAA+B,OAAA,EAAd/B,cAAc,CAAAgC,IAAA;IAAAC,UAAA,EAFb;EAAM","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}